[1m[36m┌[39m[0m[36m────────────────────────────────────────────────────────────[39m[1m[36m┐[39m[0m
[1m[36m│[39m[0m [1m[96m⚙️  Valknut v1.2.2 - AI-Powered Code Analysis[39m[0m [1m[36m│[39m[0m
[1m[36m└[39m[0m[36m────────────────────────────────────────────────────────────[39m[1m[36m┘[39m[0m

[32m✅ Configuration loaded with comprehensive analysis enabled[39m
  📊 Analysis Configuration:
    • Confidence threshold: 70.0%
    • Max files: unlimited
    • Coverage max age: 7 days
    • Coverage patterns: 26 patterns
    • Clone detection: denoising enabled (similarity: 82%)
[1m[94m📂 Validating Input Paths[39m[0m

  📁 Directory: [32m./src[39m

[1m📁 Output directory:[0m [36m./test-output2[39m
[1m📊 Report format:[0m [36mJSON[39m

[1m[94m📋 Coverage File Discovery Preview[39m[0m
  [32m✅[39m Found 1 coverage files:
    1. ./coverage.lcov (format: Lcov, size: 696 KB)

[1m[94m🔍 Starting Comprehensive Analysis Pipeline[39m[0m
  Enabled Analyses:
    ✅ Complexity Analysis - Cyclomatic and cognitive complexity scoring
    ✅ Structure Analysis - Directory organization and architectural patterns
    ✅ Refactoring Analysis - Refactoring opportunity detection
    ✅ Impact Analysis - Dependency graphs, cycles, and centrality
    ✅ Clone Detection - LSH-based similarity analysis (with denoising)
    ✅ Coverage Analysis - Test gap analysis
  📊 Total: 6 analyses enabled

[2m2025-09-14T02:01:36.940069Z[0m [32m INFO[0m Initializing Valknut analysis engine
[2m2025-09-14T02:01:36.940107Z[0m [32m INFO[0m WeightedShingleAnalyzer enabled for clone denoising with k=3
[2m2025-09-14T02:01:36.940111Z[0m [32m INFO[0m LSH extractor configured with denoising enabled (k=3)
[2m2025-09-14T02:01:36.941477Z[0m [32m INFO[0m Valknut engine initialized successfully
[2m2025-09-14T02:01:36.942422Z[0m [32m INFO[0m Starting directory analysis: ./src
🔍 ENGINE DEBUG: Calling pipeline.analyze_directory
[2m2025-09-14T02:01:36.942453Z[0m [32m INFO[0m Starting comprehensive analysis 86d81c4b-d9c9-4183-9c77-792ca4fa6c29 for 1 paths
[2m2025-09-14T02:01:36.948057Z[0m [32m INFO[0m Discovered 61 files for analysis
[2m2025-09-14T02:01:37.076703Z[0m [32m INFO[0m Analyzing complexity for file: ./src/api/engine.rs
[2m2025-09-14T02:01:37.100372Z[0m [32m INFO[0m Analyzing complexity for file: ./src/api/config_types.rs
[2m2025-09-14T02:01:37.127733Z[0m [32m INFO[0m Analyzing complexity for file: ./src/api/results.rs
[2m2025-09-14T02:01:37.159596Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/cli/mod.rs
[2m2025-09-14T02:01:37.161676Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/cli/output.rs
[2m2025-09-14T02:01:37.224733Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/cli/args.rs
[2m2025-09-14T02:01:37.227650Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/cli/commands.rs
[2m2025-09-14T02:01:37.263160Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/mcp/mod.rs
[2m2025-09-14T02:01:37.267149Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/mcp/protocol.rs
[2m2025-09-14T02:01:37.268960Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/mcp/server.rs
[2m2025-09-14T02:01:37.272790Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/mcp/tools.rs
[2m2025-09-14T02:01:37.284205Z[0m [32m INFO[0m Analyzing complexity for file: ./src/bin/valknut.rs
[2m2025-09-14T02:01:37.290786Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/pipeline/pipeline_results.rs
[2m2025-09-14T02:01:37.293092Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/pipeline/pipeline_config.rs
[2m2025-09-14T02:01:37.295028Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/pipeline/pipeline_executor.rs
[2m2025-09-14T02:01:37.308336Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/pipeline/mod.rs
[2m2025-09-14T02:01:37.314759Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/pipeline/pipeline_stages.rs
[2m2025-09-14T02:01:37.321424Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/errors.rs
[2m2025-09-14T02:01:37.329430Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/featureset.rs
[2m2025-09-14T02:01:37.344684Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/bayesian.rs
[2m2025-09-14T02:01:37.359054Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/config.rs
[2m2025-09-14T02:01:37.373508Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/scoring.rs
[2m2025-09-14T02:01:37.386500Z[0m [32m INFO[0m Analyzing complexity for file: ./src/core/file_utils.rs
[2m2025-09-14T02:01:37.395612Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/graph.rs
[2m2025-09-14T02:01:37.402623Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/structure/config.rs
[2m2025-09-14T02:01:37.405117Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/structure/mod.rs
[2m2025-09-14T02:01:37.409567Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/structure/directory.rs
[2m2025-09-14T02:01:37.453710Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/structure/file.rs
[2m2025-09-14T02:01:37.486010Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/refactoring.rs
[2m2025-09-14T02:01:37.495500Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/coverage.rs
[2m2025-09-14T02:01:37.610222Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/mod.rs
[2m2025-09-14T02:01:37.614289Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/complexity.rs
[2m2025-09-14T02:01:37.646586Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/names_simple.rs
[2m2025-09-14T02:01:37.662024Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/boilerplate_learning.rs
[2m2025-09-14T02:01:37.671624Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/clone_detection.rs
[2m2025-09-14T02:01:37.715399Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/lsh/lsh_cache.rs
[2m2025-09-14T02:01:37.720868Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/lsh/memory_pool.rs
[2m2025-09-14T02:01:37.723994Z[0m [32m INFO[0m Analyzing complexity for file: ./src/detectors/lsh/mod.rs
[2m2025-09-14T02:01:37.752998Z[0m [32m INFO[0m Analyzing complexity for file: ./src/io/mod.rs
[2m2025-09-14T02:01:37.753678Z[0m [32m INFO[0m Analyzing complexity for file: ./src/io/persistence.rs
[2m2025-09-14T02:01:37.753983Z[0m [32m INFO[0m Analyzing complexity for file: ./src/io/cache.rs
[2m2025-09-14T02:01:37.780789Z[0m [32m INFO[0m Analyzing complexity for file: ./src/io/reports.rs
[2m2025-09-14T02:01:37.808934Z[0m [32m INFO[0m Analyzing complexity for file: ./src/lang/go.rs
[2m2025-09-14T02:01:37.820862Z[0m [32m INFO[0m Analyzing complexity for file: ./src/lang/javascript.rs
[2m2025-09-14T02:01:37.827473Z[0m [32m INFO[0m Analyzing complexity for file: ./src/lang/typescript.rs
[2m2025-09-14T02:01:37.836335Z[0m [32m INFO[0m Analyzing complexity for file: ./src/lang/rust_lang.rs
[2m2025-09-14T02:01:37.847221Z[0m [32m INFO[0m Analyzing complexity for file: ./src/lang/common.rs
[2m2025-09-14T02:01:37.853904Z[0m [32m INFO[0m Analyzing complexity for file: ./src/lang/mod.rs
[2m2025-09-14T02:01:37.854204Z[0m [32m INFO[0m Analyzing complexity for file: ./src/lang/python.rs
[2m2025-09-14T02:01:37.867573Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/scoring.rs
[2m2025-09-14T02:01:37.876301Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/types.rs
[2m2025-09-14T02:01:37.882757Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/storage.rs
[2m2025-09-14T02:01:37.890639Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/reports.rs
[2m2025-09-14T02:01:37.896619Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/community.rs
[2m2025-09-14T02:01:37.907120Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/collectors.rs
[2m2025-09-14T02:01:37.922620Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/graph.rs
[2m2025-09-14T02:01:37.943929Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/stacks.rs
[2m2025-09-14T02:01:37.948345Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/mod.rs
[2m2025-09-14T02:01:37.951833Z[0m [32m INFO[0m Analyzing complexity for file: ./src/live/cli.rs
[2m2025-09-14T02:01:37.959830Z[0m [32m INFO[0m Analyzing complexity for file: ./src/oracle/mod.rs
[2m2025-09-14T02:01:37.975878Z[0m [32m INFO[0m Analyzing complexity for file: ./src/lib.rs
[2m2025-09-14T02:01:37.980130Z[0m [32m INFO[0m Running refactoring analysis on 61 files
Found potential duplicate line 241: 'if trimmed.contains("this appears multiple times") {'
Found potential duplicate line 608: 'let duplicate_line = "this appears multiple times";'
Found potential duplicate line 612: 'let duplicate_line2 = "this appears multiple times";'
Found potential duplicate line 616: 'let duplicate_line3 = "this appears multiple times";'
[2m2025-09-14T02:01:38.022391Z[0m [32m INFO[0m Refactoring analysis found 49 files with opportunities
[2m2025-09-14T02:01:38.046867Z[0m [32m INFO[0m Computing weighted signatures for 62 entities (cache miss)
[2m2025-09-14T02:01:38.046934Z[0m [32m INFO[0m Building IDF table for 62 entities with k=3
[2m2025-09-14T02:01:38.166770Z[0m [32m INFO[0m grams_total: 72353, grams_top1pct_pctcontrib: 7.1%
[2m2025-09-14T02:01:38.370020Z[0m [32m INFO[0m Computed weighted signatures for 61 entities
[2m2025-09-14T02:01:38.554045Z[0m [32m INFO[0m Using coverage file: ./coverage.lcov (format: Lcov)
[2m2025-09-14T02:01:38.554564Z[0m [32m INFO[0m Comprehensive analysis completed in 1.61s
[2m2025-09-14T02:01:38.554600Z[0m [32m INFO[0m Total issues found: 366
[2m2025-09-14T02:01:38.554604Z[0m [32m INFO[0m Overall health score: 75.7
🔍 ENGINE DEBUG: Pipeline returned 1761 scoring files
DEBUG: SRC calculation - entities: 3, refactoring: 0, avg_score: 0
DEBUG: DirectoryHealthTree has 14 directories
DEBUG: Directory "src/detectors/structure" has health 28.3%, children: []
DEBUG: Directory "src/io" has health 29.9%, children: []
DEBUG: Directory "src/detectors/lsh" has health 26.4%, children: []
DEBUG: Directory "src" has health 100.0%, children: ["src/api", "src/bin", "src/core", "src/detectors", "src/io", "src/lang", "src/live", "src/oracle"]
DEBUG: Directory "src/live" has health 38.0%, children: []
DEBUG: Directory "src/lang" has health 25.0%, children: []
DEBUG: Directory "src/oracle" has health 5.5%, children: []
DEBUG: Directory "src/bin/cli" has health 29.4%, children: []
DEBUG: Directory "src/core" has health 44.0%, children: ["src/core/pipeline"]
DEBUG: Directory "src/bin" has health 53.3%, children: ["src/bin/cli", "src/bin/mcp"]
DEBUG: Directory "src/detectors" has health 23.7%, children: ["src/detectors/lsh", "src/detectors/structure"]
DEBUG: Directory "src/core/pipeline" has health 24.6%, children: []
DEBUG: Directory "src/api" has health 39.2%, children: []
DEBUG: Directory "src/bin/mcp" has health 0.7%, children: []
DEBUG: Coverage enabled: true, files used: 1
DEBUG: Generated 1 coverage packs
[2m2025-09-14T02:01:38.577137Z[0m [32m INFO[0m Directory analysis completed: 61 files processed, 1761 entities analyzed
[1m[94m📊 Analysis Results[39m[0m

  ✅ Analysis completed successfully

[1m[94m📝 Generating Reports[39m[0m
  ✅ Report saved: [36m./test-output2/analysis-results.json[39m
[1m[32m🎉 Analysis completed successfully![39m[0m
